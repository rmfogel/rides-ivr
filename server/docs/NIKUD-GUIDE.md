# מדריך שימוש בניקוד בהקלטות

## תמיכה בניקוד (Vowel Points)

מערכת ה-TTS של Google Cloud תומכת בניקוד עברי! ניתן להוסיף ניקוד ישירות לטקסט ב-`dictionary.json`.

## איך להוסיף ניקוד?

### דרך 1: ניקוד ישיר בטקסט

פשוט הוסף את סימני הניקוד לטקסט העברי:

```json
{
  "002": "לְנַהֵג הַקֵּשׁ 1. לְנוֹסֵעַ הַקֵּשׁ 2. לְעִדְכּוּן נְסִיעוֹת שֶׁנִּשְׁמְרוּ הַקֵּשׁ 3.",
  "130": "לִמְחִיקַת נְסִיעוֹת הַקֵּשׁ 1."
}
```

### דרך 2: שימוש ב-SSML לשליטה מדויקת

ניתן להשתמש ב-SSML לשליטה טובה יותר:

```json
{
  "002": "<speak>לְנַהֵג הַקֵּשׁ <break time='200ms'/> אֶחָד. <break time='100ms'/> לְנוֹסֵעַ הַקֵּשׁ <break time='200ms'/> שְׁתַּיִם.</speak>"
}
```

## סימני ניקוד נפוצים

| סימן | שם | Unicode | דוגמה |
|------|-----|---------|--------|
| ַ | פתח | \u05B7 | לַ |
| ָ | קמץ | \u05B8 | לָ |
| ֶ | סגול | \u05B6 | לֶ |
| ֵ | צירה | \u05B5 | לֵ |
| ִ | חיריק | \u05B4 | לִ |
| ֹ | חולם | \u05B9 | לֹ |
| ֻ | קובוץ | \u05BB | לֻ |
| ְ | שווא | \u05B0 | לְ |
| ּ | דגש | \u05BC | בּ |
| ׁ | שין | \u05C1 | שׁ |
| ׂ | שין | \u05C2 | שׂ |

## תגי SSML שימושיים

### הפסקות (Breaks)
```xml
<break time="500ms"/> <!-- הפסקה של חצי שנייה -->
<break strength="strong"/> <!-- הפסקה חזקה -->
```

### הדגשות (Emphasis)
```xml
<emphasis level="strong">חשוב מאוד</emphasis>
```

### קצב דיבור (Speaking Rate)
```xml
<prosody rate="slow">טקסט איטי</prosody>
<prosody rate="fast">טקסט מהיר</prosody>
```

### גובה קול (Pitch)
```xml
<prosody pitch="+2st">קול גבוה יותר</prosody>
<prosody pitch="-2st">קול נמוך יותר</prosody>
```

### עוצמת קול (Volume)
```xml
<prosody volume="loud">רועש</prosody>
<prosody volume="soft">שקט</prosody>
```

## דוגמאות מלאות

### דוגמה 1: תפריט עם ניקוד והפסקות
```json
{
  "002": "<speak>לְנַהֵג <break time='200ms'/> הַקֵּשׁ <prosody rate='slow'>אֶחָד</prosody>. <break time='300ms'/> לְנוֹסֵעַ <break time='200ms'/> הַקֵּשׁ <prosody rate='slow'>שְׁתַּיִם</prosody>.</speak>"
}
```

### דוגמה 2: הודעת אישור עם הדגשה
```json
{
  "136": "<speak>הַנְּסִיעָה נִמְחֲקָה <emphasis level='strong'>בְּהַצְלָחָה</emphasis>!</speak>"
}
```

### דוגמה 3: שאלה עם הפסקה
```json
{
  "135": "<speak>הַאִם אַתָּה בָּטוּחַ <break time='300ms'/> שֶׁבִּרְצוֹנְךָ לִמְחֹק אֶת הַנְּסִיעָה? <break time='500ms'/> הַקֵּשׁ אֶחָד לְאִישׁוּר <break time='200ms'/> אוֹ שְׁתַּיִם לְבִיטוּל.</speak>"
}
```

## איך לעדכן ההקלטות עם ניקוד?

1. **ערוך את `dictionary.json`** והוסף ניקוד לטקסטים:
   ```bash
   notepad server\public\audio\he\dictionary.json
   ```

2. **הפעל את הסקריפט מחדש**:
   ```powershell
   cd server
   $env:GOOGLE_APPLICATION_CREDENTIALS="$PWD\tts-key.json"
   npm run audio:regenerate
   ```

3. **בדוק את התוצאה** - השמע בקבצי ה-MP3 החדשים

## טיפים לשימוש מוצלח

1. **התחל בפשוט** - נקד רק מילים שמבוטאות לא נכון
2. **השתמש בהפסקות** - עוזר להבהיר את המבנה
3. **בדוק את התוצאה** - האזן לקבצים שנוצרו
4. **שמור גרסה ישנה** - לפני שאתה מחליף את כל ההקלטות

## כלים מועילים

### כלי ניקוד אונליין
- https://nakdan.dicta.org.il/ - מנקד אוטומטי של דיקטה
- https://www.morfix.co.il/ - מילון עם ניקוד

### בדיקת Unicode
אם אתה לא בטוח איזה סימן להשתמש, תעתיק מהדוגמאות למעלה.

## פתרון בעיות

### הניקוד לא עובד
- ודא שהקובץ `dictionary.json` שמור ב-UTF-8
- בדוק שהסימנים מופיעים נכון בעורך הטקסט

### SSML לא עובד
- ודא שהטקסט מתחיל ב-`<speak>` ומסתיים ב-`</speak>`
- בדוק שכל התגים סגורים נכון

### ההגייה עדיין לא טובה
- נסה ניקוד שונה
- השתמש ב-`<phoneme>` לשליטה מדויקת:
  ```xml
  <phoneme alphabet="ipa" ph="təʁɛmpˈjada">טרמפיאדה</phoneme>
  ```

## דוגמאות מהמערכת

הנה כמה דוגמאות לניקוד של הודעות קיימות:

```json
{
  "001": "בְּרוּכִים הַבָּאִים לְטֶרֶמְפְּיַאדָה.",
  "002": "לְנַהֵג הַקֵּשׁ 1. לְנוֹסֵעַ הַקֵּשׁ 2. לְעִדְכּוּן נְסִיעוֹת שֶׁנִּשְׁמְרוּ הַקֵּשׁ 3.",
  "061": "תּוֹדָה וּלְהִתְרָאוֹת.",
  "130": "לִמְחִיקַת נְסִיעוֹת הַקֵּשׁ 1.",
  "131": "אֵין לְךָ נְסִיעוֹת פְּעִילוֹת.",
  "135": "הַאִם אַתָּה בָּטוּחַ שֶׁבִּרְצוֹנְךָ לִמְחֹק אֶת הַנְּסִיעָה? הַקֵּשׁ 1 לְאִישׁוּר אוֹ 2 לְבִיטוּל.",
  "136": "הַנְּסִיעָה נִמְחֲקָה בְּהַצְלָחָה."
}
```

## עדכון אוטומטי

אם יש לך קובץ טקסט מנוקד, תוכל להעתיק ולהדביק ישירות ל-`dictionary.json`.

---

**שים לב:** הסקריפט `generate-audio.js` מזהה אוטומטית ניקוד ו-SSML ומשתמש בהם!
